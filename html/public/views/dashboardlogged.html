<html lang="it">
  <head>
    
    <title>Dashboard logged</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--<script src="https://unpkg.com/@popperjs/core@2"></script>-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/login.css">
    <link rel="stylesheet" type="text/css" href="/css/backofficelogged.css">
    <script type="text/javascript" src="/js/backofficelogged.js"></script>
    <link rel="shortcut icon" href="#">
    <script src="//code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

    <!-- anychart cdn -->
    <script src="https://cdn.anychart.com/releases/8.11.0/js/anychart-base.min.js"></script>
    <!-- angular cdn -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
    <!-- axios -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <!-- underscore.js -->
    <script src="https://cdn.jsdelivr.net/npm/underscore@1.13.2/underscore-umd-min.js"></script>




	
  </head>

  <body style="background-color: #dac5b4;">                       

                                                            <!-- NAVBAR -->

<nav class="navbar navbar-dark bg-dark sticky-top">
  <div class="container-fluid">
    <div class="navbar-brand ml-auto">      
      <div class="btn-group">
        <button class="btn btn-dark btn-outline-light btn-lg" type="button"> DASHBOARD LOGGED</button>
        <button type="button" class="btn btn-outline-light btn-lg btn-dark dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false">
          <span class="visually-hidden">Vedi Azioni Dropdown</span>
        </button>
          <ul class="dropdown-menu" aria-labelledby="dropdownMenuLink">
          
             <li class="nav-item">
              <button type="button" class="btn btn-lg" data-bs-toggle="modal" data-bs-target="#anagraficaClientiModal" onclick="">
               Anagrafica clienti
              </button>
             </li>
             <li class="nav-item">
              <button type="button" class="btn btn-lg" data-bs-toggle="modal" data-bs-target="#vediInventarioModal" onclick="">
                Modifica inventario
               </button>
             </li>
            
          </ul>
      </div>
    </div>
      <form class="d-flex w-50 bottom-0 my-auto">
        <input class="form-control me-2" type="search" placeholder="Cerca" aria-label="inserisci la tua parola chiave di ricerca">
        <button class="btn btn-outline-light" type="submit">Cerca</button>
      </form>
      <ul class="navbar-nav mr-auto">
        <li class="nav-item">   
          <a href="/dashboardlogout">
            <button type="button" class="btn btn-outline-light" data-bs-toggle="modal" data-bs-target="#myModal" aria-label="Esci dalla dashboard">ESCI</button>  
          </a>                    
        </li>
      </ul> 
  </div>
</nav>
 
                                                   <!-- FINE NAVBAR -->
  <div style="margin: 100px" ng-app="myApp" ng-controller="myCtrl" data-ng-init="init()">
    <div ng-repeat="item in items">
      <p>{{ item.game }} per {{ item.platform }}</p>
    </div>
    <!--<div id="clienti" style="width: auto; height: 1000px;"></div>-->
    <!--<button onclick="addPoint()">aggiungi</button>-->
    <div id="noleggi"></div>
  </div>


  </body>

<script type="text/javascript">
  var app = angular.module("myApp", []);
  app.controller('myCtrl', function($scope, $http) {
  $http({
    method : "GET",
      url : "/db/getGames"
  }).then(function mySuccess(response) {
    $scope.items = response.data.result;
    console.log($scope.items.length);

    anychart.onDocumentReady(function () {

      data = anychart.data.set([
      ]);

      var chart = anychart.bar();
      var series = chart.bar(data);
      chart.title("Panoramica Oggetti");
      chart.xAxis().title("Piattaforma");
      chart.yAxis().title("Numero giochi");
      chart.container("noleggi").draw();

      //newIndex = (data.mapAs().getRowsCount())+1;
      /*
      let platformCount = [];
      $scope.items.forEach(item => {
        if (item.platform === 'Playstation 4'){
          platformCount.ps4++;
        }
        else if (item.platform === 'Playstation 5'){
          platformCount.ps5++;
        }
        else if (item.platform === 'Pc'){
          platformCount.pc++;
        }
        else if (item.platform === 'Xbox One'){
          platformCount.xone++;
        }
      })
      console.log(platformCount);
      */
      let count = [];
      $scope.items.forEach(function (a) {
        count[a.platform] = (count[a.platform] || 0) + 1;
      });
      console.log(count);

      data.append({
        x: 'PC',
        value : count['Pc']
      });
      data.append({
        x: 'PS4',
        value : count['Playstation 4']
      });
      data.append({
        x: 'PS5',
        value : count['Playstation 5']
      });
      data.append({
        x: 'Xbox One',
        value : count['Xbox One']
      });
    });


  }, function myError(response) {
    $scope.items = response.statusText;
  });
  $scope.init = function () {
  };
  });

/*
  anychart.onDocumentLoad(function () {
    // create an instance of a pie chart
    var chart = anychart.pie();
    // set the data
    chart.data([
      ["Chocolate", 5],
      ["Rhubarb compote", 2],
      ["CrÃªpe Suzette", 2],
      ["American blueberry", 2],
      ["Buttermilk", 1]
    ]);
    // set chart title
    chart.title("Panoramica Clienti");
    // set the container element 
    chart.container("clienti");
    // initiate chart display
    chart.draw();
  });

function addPoint() {
  newIndex = (data.mapAs().getRowsCount())+1;
  data.append({
    x: "P" + newIndex,
    value : Math.floor((Math.random() * 100)+ 1)
  });
};
*/
</script>
</html>