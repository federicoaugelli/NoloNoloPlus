<!doctype html>
<html lang="it">
  <head>
      <title>Frontoffice logged</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      
      <!-- Bootstrap CDN -->
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet">
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
      <link rel="shortcut icon" href="#">

      <!-- vue.js CDN
      <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14"></script>
      -->

      <!-- vue.js -->
      <script type="text/javascript" src="/js/vue.min.js"></script>
      <link rel="stylesheet" type="text/css" href="/css/frontoffice.css">
      <link rel="stylesheet" type="text/css" href="/css/login.css">
      <script type="text/javascript" src="/js/frontoffice.js"></script>


</head>

<body style="background-color: #031336;">
  <div id="app">


  
  <!-- Modal cards 
  <div class="modal fade" id="card-modal" tabindex="-1" aria-labelledby="card-modalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">{{ item.game }} per {{ item.platform }}</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="card-body">
            <label for="startRent">Da:</label>
            <input type="date" id="startRent" name="startRent">

            <label for="finishRent">A:</label>
            <input type="date" id="finishRent" name="finishRent">
          </div>
        </div>
        <div class="modal-footer">
          <p class="me-auto">costo: $</p>
          <button type="button" class="btn btn-primary" disabled>Noleggia</button>
        </div>
      </div>
    </div>
  </div>
  -->

  <!-- NAVBAR -->
    <nav class="navbar navbar-dark navbar-expand-md bg-primary sticky-top py-4">
      <div class="container-fluid">
        <a class="navbar-brand ml-auto">NOLO NOLO</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsExample04" aria-controls="navbarsExample04" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
          <form class="d-flex w-50 bottom-0 my-auto">
            <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search" v-model="searchQuery">
          </form>
          <ul class="navbar-nav mr-auto">
            <li class="nav-item">   
              <a href="/frontendlogout">
                <button type="button" class="btn btn-outline-light" data-bs-toggle="modal" data-bs-target="#myModal"> ESCI</button>  
              </a>                    
            </li>
          </ul> 
      </div>
    </nav>

    <div class="btn-group filterBar">
      <button v-if="searchQuery != ''" class="btn btn-danger" type="button" v-on:click="searchQuery = ''">Elimina filtro</button>
      <button class="btn btn-light active" :class="{ active: searchQuery == 'Playstation 5' }" type="button" v-on:click="searchQuery = 'Playstation 5'">ps5</button>
      <button class="btn btn-light" type="button" v-on:click="searchQuery = 'Playstation 4'">ps4</button>
      <button class="btn btn-light" type="button" v-on:click="searchQuery = 'Xbox One'">Xbox</button>
      <button class="btn btn-light" type="button" v-on:click="searchQuery = 'Nintendo'">Nintendo</button>
      <button class="btn btn-light" type="button" v-on:click="searchQuery = 'Pc'">Pc</button>
      <button class="btn btn-light" type="button" v-on:click="searchQuery = 'Nuovo'">Nuovi</button>
      <button class="btn btn-light" type="button" @click="">Disponibili</button>
    </div>

  <!-- TABELLA FINALE -->
  <div class="album py-5">
    <div class="container">
      <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">

        <div class="col" v-for="item in resultQuery" :key="item.game">
          <!-- implementare card 'Nessun elemento' -->
          <div class="card shadow-sm gameCard" style="text-align: center;">
            <div class="pegi">PEGI {{ item.etaMinima }}</div>
            <img v-if="item.platform == 'Playstation 4' || item.platform == 'Playstation 5'" class="platform-logo playstation" src="/img/playstation-brands.svg" alt="Card image1">
            <img v-else-if="item.platform == 'Xbox One'" class="platform-logo xbox" src="/img/xbox-brands.svg" alt="Card image1">
            <img v-else-if="item.platform == 'Pc'" class="platform-logo pc" src="/img/laptop-solid.svg" alt="Card image1">
            <div v-else class="platform-logo nintendo">Nintendo</div>
            <img class="card-img-top" src="/img/prova1.png" alt="Card image1">
            <div class="card-body">
              <h4 class="card-title" style="color: white;">{{ item.game }}</h4>
              <!--
              <a class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#card-modal">Noleggia</a>-->
              <a data-bs-toggle="modal" data-bs-target="#card-modal" class="rentbtn">
                <span></span>
                <span></span>
                <span></span>
                <span></span>
                Noleggia
              </a>
              <h6 style="color: white; margin-top: 10px;">{{ item.prezzo }}â‚¬ al giorno</h6>
            </div>
            <div class="card-footer">
              <small class="text-muted" style="position: absolute; right: 0; margin-right: 10px;">{{ item.annoUscita }}</small>
              <small class="text-muted">in {{ item.condizioni }} condizioni</small>
            </div>


  <div class="modal fade" id="card-modal" tabindex="-1" aria-labelledby="card-modalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">{{ item.game }} per {{ item.platform }}</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="card-body">
            <label for="startRent">Da:</label>
            <input type="date" id="startRent" name="startRent">

            <label for="finishRent">A:</label>
            <input type="date" id="finishRent" name="finishRent">
          </div>
        </div>
        <div class="modal-footer">
          <p class="me-auto">costo: $</p>
          <!-- <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Chiudi</button> -->
          <button type="button" class="btn btn-primary" disabled>Noleggia</button>
        </div>
      </div>
    </div>
  </div>


          </div>
        </div>

      </div>
    </div>
  </div>


    <!--  LISTA PAGINE
    <nav aria-labelledby="lista-pagine" class="my-5">
      <ul class="pagination justify-content-center" style="margin:20px">
        <li class="page-item"><a class="page-link" aria-current="" href="#">Precedente</a></li></li>
        <li class="page-item"><a class="page-link" aria-current="" href="#">1</a></li></li>
        <li class="page-item"><a class="page-link" aria-current="" href="#">2</a></li></li>
        <li class="page-item"><a class="page-link" aria-current="" href="#">3</a></li></li>
        <li class="page-item"><a class="page-link" aria-current="" href="#">Successiva</a></li></li>
     </ul>
    </nav>
    -->

 </div>

  <script type="text/javascript">
      
    new Vue({
      el: "#app",
      data () {
        return {
          searchQuery: '',
          items: ''
        }
      },

      mounted () {
        axios
          .get('/db/getGames')
          .then(response => (this.items = response.data.result))
      },

      computed: {
        resultQuery(){
          if(this.searchQuery !== "" && this.searchQuery !== "Nuovo" && this.searchQuery !== "Playstation 5" && this.searchQuery !== "Playstation 4" && this.searchQuery !== "pc" && this.searchQuery !== "Nintendo"){
            return this.items.filter((gg)=>{
              return this.searchQuery.toLowerCase().split(' ').every(v => gg.game.toLowerCase().includes(v))
            })
          }
          else if (this.searchQuery == "Nuovo"){
            return this.items.filter((gg)=>{
              return this.searchQuery.toLowerCase().split(' ').every(v => gg.stato.toLowerCase().includes(v))
            })
          }
          else if (this.searchQuery == "Playstation 5"){
            return this.items.filter((gg)=>{
              return this.searchQuery.toLowerCase().split(' ').every(v => gg.platform.toLowerCase().includes(v))
            })
          }
          else if (this.searchQuery == "Playstation 4"){
            return this.items.filter((gg)=>{
              return this.searchQuery.toLowerCase().split(' ').every(v => gg.platform.toLowerCase().includes(v))
            })
          }
          else if (this.searchQuery == "Nintendo"){
            return this.items.filter((gg)=>{
              return this.searchQuery.toLowerCase().split(' ').every(v => gg.platform.toLowerCase().includes(v))
            })
          }
          else if (this.searchQuery == "Pc"){
            return this.items.filter((gg)=>{
              return this.searchQuery.toLowerCase().split(' ').every(v => gg.platform.toLowerCase().includes(v))
            })
          }
          else if (this.searchQuery == "Playstation 5"){
            return this.items.filter((gg)=>{
              return this.searchQuery.toLowerCase().split(' ').every(v => gg.platform.toLowerCase().includes(v))
            })
          }
          else{
            return this.items;
          }
        }

      },
    })

/*
  Implementare il modal con il prezzo moltiplicato per i giorni (non loggati)
  implementare i filtri per i loggati
  implementare le altre cose per i loggati
*/

  </script>
</div>
</body>
</html>